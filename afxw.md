# あふｗ

あふとは，[FD](https://ja.wikipedia.org/wiki/FD_(%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E7%AE%A1%E7%90%86%E3%82%BD%E3%83%95%E3%83%88))ライクなテキストベースの２画面ファイラのことです．  
このドキュメントは，Windowsユーザー向け，特に画像処理エンジニアへの２画面ファイラの導入を勧めるための情報です．  

あふのリンクはこちら．[リンク](http://akt.d.dooo.jp/akt_afxw.html)．

# 概要
画像処理をやっている人の主な作業は主に以下のような作業です．
* コードを編集する
* 画像を確認する
* csvファイルなどを確認，プロットする
* 参考資料（pdf，tex，text）ファイルを確認する
* ファイル整理をする
* ドキュメント（doc, ppt, tex, md）を書く
* ネットで調べものをする．

通常，このような作業をするときには，Windowsネイティブのエクスプローラ（インターネットエクスプローラーではなくて普通のフォルダアイコンを押すと出てくるウィンドウのことをエクスプローラーと呼ぶ）で行うと，以下のような作業を行うことになります．
**ファイル編集する場合**
1. マイドキュメントなどをクリック
2. ファイルを探しながら目的のフォルダまで移動
3. 目的のファイルを探してダブルクリックして実行．

**ファイル整理する場合**
1. マイドキュメントなどをクリック
2. ファイルを探しながら目的のフォルダまで移動
3. 目的のファイルを探してダブルクリックして実行し中身を確認．
4. 必要なファイルを目的のフォルダにコピーや移動や削除

これは，非常に工程数が多く，たくさんダブルクリックする必要があります．
また，無数のファイルの中から適切なファイルを見つけることは大変です．

ダブルクリックする時間やファイル名で目的のものを見つける時間はたかがしれていると思うかもしれませんが，塵も積もれば山となります．
また，人間の短期記憶にはそんなに作業を記憶しておくことができず，これをこっちのウィンドウにコピーして，一回リネームしておいて，このファイルを．．．といった作業をやろうとするとすぐにやろうとしていた作業を忘れてしまうため意外とファイル整理には時間がかかります．
しかも，中身を確認するためにダブルクリックして，テキストエディタ，pdfビューアやら画像ビューア，ワードやエクセル，パワーポイントや圧縮ソフトなど様々なソフトウェアが起動して画面が散らかります．
また，コマンドプロンプトなどを使ったツールと連携するためには，適切なカレントディレクトリに移動して操作をしなければなりません．
（エクスプローラのファイルパスを入力する欄でcmdと打つとそこをカレントディレクトリにしてコマンドプロンプトが起動するっていう小技を知っているとちょっと楽）
これらの作業は，実はコンピュータを使った作業における中心的な作業になります．
つまりこれを効率化すると，普段の作業効率が改善します．

あふを使えば，この作業が（簡単な確認だけなら）あふだけで収まり，非常に簡単になります．

あふで出来ることはたくさんありますが，通常のダブルクリックによるファイル実行に相当する作業は当然として，代表的なものを列挙すると下記のようなことが出来ます．

* ファイル整理（ファイルのソート・マスク，ディレクトリ作成，コピー，移動，削除，リネーム）
* テキストファイルの閲覧
* 画像の閲覧，pdfを画像として閲覧
* ワード，エクセル，パワーポイントをテキストファイルとして閲覧
* 外部ツールの呼び出し（gnuplot, コマンドプロンプト，imagemagick, ffmpeg，diffコマンドの呼び出しなど）

* ファイルの圧縮，展開
ctrl+[a-z1-9]頭文字のファイルにジャンプ
q あふの修了
a すべて選択
z 環境設定1
w ファイルサイズ，タイムスタンプを比較してマーク
s ソート
x ** 左右の状態のふっしゅ
e テキストファイルとして編集
d ファイルを削除
shift+d ごみ箱を経由せず完全に削除
c コピー
shift+c fastCopyを使って非同期コピー
r　リネーム
shift+r リネームして同じフォルダに複製を作成
f 検索
shift+ f　検索
v バイナルファイルorテキストファイルとして閲覧（tabキーで切り替え）
t ** ブックマークを起動
g ** デスクトップに移動
b ** コマンドラインを起動
y ** 一つ上のフォルダにファイルを移動（gmailのアーカイブのショートカットキー）
h 閲覧履歴表示とジャンプ
n ** ファイル名をクリックボードにコピーキー割り当てなし？？
u 圧縮ファイルの展開：unpack
shift+u 　圧縮ファイルの展開をど同ォルダに展開
j 登録フォルダにジャンプ
shift+j タイプしたフォルダにジャンプ
m 移動
shift+m fastcopyを使って非同期移動
i 割り当てなし？
k フォルダの作成
，割り当てなし？
o 割り当てなあし
l ドライブレターの変更
．アイコンの表示非表示切り替え
shift+.でかいアイコンで表示
p フォルダの圧縮：pack
ｐを押した後にctrl+[1-9]で圧縮レベルの変更可能
＋割り当てなし
ctrl+/　よみこみdllの一覧表示
\ ルートディレクトリにジャンプ
[
]なし？
\右クリック
shift+\右クリックして反対にドロップ

alt+g grep


t ** フォルダのブックマークの編集
shift+t ツールのブックマーク
え
shift+z 環境設定2
shift+z 環境設定2
r ファイル名，属性，タイムスタンプの変更
h 履歴の表示
j 登録フォルダにジャンプ

画像モード
* M 画像表示位置切り替え
* End 画像を画面にフィットして表示
* Shift+矢印 スクロール
* Inc Del 拡大，縮小
* Shift+R/L 左回転，右回転
* Alt+Enter/F4/F　フルスクリーン

何も拡張していないバニラな状態では少し使いにくいためある程度の拡張は必須です．少なくとも以下の拡張は必須です．

* ファイルの色分け
* 画像閲覧用のsusieプラグインの導入
* 圧縮展開用のdllの導入
* キーボードショートカット用のユーティリティの追加
* よく使うフォルダの登録
* 非同期コピー，移動の設定
履歴の状態のプッシュとポップ

# 拡張用のメモ
研究室では，必要なファイルをコピーすればいいだけです．
x64のあふは使いたいdllが一部対応できていなかったりする関係で今はx86を使っています．

必要な拡張
表示カラーの変更
まず，あふを起動すると黒いバックに，白い文字等でファイルが表示されています．
視認性が悪いため，設定で色を付けましょう．

zでコンフィグ設定を起動して，何も設定せずに決定を押せば，AFXW.DEFファイルができます．
このファイルは，さまざまな設定を記述できるファイルです．
ここに下記のカラーの設定を追記します．
するとエグゼや圧縮ファイルなどの拡張子に色が付きます．
```
[REG_COL]
COL_00=255
EXT_00=exe bat
COL_01=33023
EXT_01=lnk
COL_02=65535
EXT_02=lzh zip 7z cab rar tgz tar bz2 gz xz msi
COL_03=16711935
EXT_03=bmp ppm pgm pbm jpg jpeg jpe png gif tif tiff webp jp2 j2k jls ico webp svg wmf emf eps ps
COL_04=8388863
EXT_04=ifo mp2 mpa m1a m2p m2a mpg mpeg m1v m2v mp2v mp4 divx mov qt ra rm ram rmvb rpm smi avi wmv asf mkv
COL_05=8454016
EXT_05=mp3 wav aac
COL_06=32768
EXT_06=m3u
COL_07=32768
EXT_07=ppt pptx
COL_08=65280
EXT_08=doc docx xls xlsx
COL_09=16776960
EXT_09=txt hlp csv mac h hpp
COL_08=65280
EXT_08=c cpp
COL_10=8421376
EXT_10=pdf xmind
COL_11=16711680
EXT_11=htm html url
COL_12=12615808
EXT_12=ini cfg dat bkp def key
COL_13=8388736
EXT_13=dll sys reg inf spi sph
COL_14=128
EXT_14=bak old tmp
COL_15=8421631
EXT_15=img iso
```

次に，afxw.iniの色の設定関連も以下に変更します．
[COL]で区切られているセクションを丸っと上書きします．
するとフォルダが緑で表示されるようになり視認性が上がりました．
```
[COL]
NORMAL=16777215
SYSFILE=16711935
HIDDEN=16776960
READONLY=255
DIR=65280
SELECT=32768
BAR=16711680
WAKU=16711680
BGFL=0
PT=16777215
BGPT=0
MB=16777215
BGMB=0
VW=16777215
BGVW=0
STS_BAR=0
STS_BAR2=65535
LNVW=65280
TBVW=8421376
CRVW=65535
```
susieプラグインのダウンロード

pdf

# 圧縮ファイルのための拡張
圧縮・展開用のdllのダウンロード
7z.dllでほぼすべての拡張子に対応可能
7zipの公式からダウンロードしてきて，中にある7z.dllをコピー
コマンドライン用の7za.dllと7zax.dllは違うものなので注意．

7-zip dll
tar64.dll
http://ayakawa.o.oo7.jp/soft/ntutil.html#7z


その他設定
ｚ→各種登録（９）→フォルダ（F）→新規にdownload　フォルダ（ｚ）にC:\Users\fukushima（ユーザー名）\Downloads\

shift+z:ファイルサイズ表示切替→KByte MByte 表示

各種設定（１）
ファイルサイズをKB MB GB TB　表示する（チェック推奨）
あふｗをESCでも終了する→チェックあったほうが便利
前回終了時のフォルダ履歴を保存して引き継ぎつぐにチェック（お好み）
ソートの状態を表示する→チェック推奨
左右逆カーソルで親フォルダに移動する→チェック推奨
ルートフォルダからバックスペースでドライブ選択を開く→（チェックしないのを推奨．．ボタン連打で失敗しやすい．）
タイムスタンプの秒表示を省略する→チェック推奨
フォルダ作成後そのフォルダに移動する→チェック外したほうがいい．（ｋでフォルダ作成をフォルダ作成したのちに反対側のまどで移動するにしたほうがいい）

irfanview
Japanese.dllをLanguagesフォルダにコピー
ｐを押してkanguageを先手くしてjapanese
大体日本語になる．

Lキー空いている
K0008="1076&MENU "$~\afxwbkmkl.mnu""

afxw.keyで拡張してあるキーバインドの確認
AfxKView.exeを起動．（そんなに確認することはないと思って）ショートカット設定していない．


[PROGRAM]
EDITOR="notepad.exe"
ED_V="$P\$F"
VIEWER=""
SUSIEPATH="%afxw%\susie"
VARCPATH=""
NXCMD=""
SXCMD=""


# 画像表示関連

## 最優先
jpg png gif bmp
主要圧縮フォーマット3つとwindows非圧縮フォーマットのbmp
# 優先
tiff pxm(ppm/pgm/pbm) wmf emf
たまに使われる画像圧縮tiffフォーマット，eps （texではもう本当は非推奨），linux系でよく使われる非圧縮フォーマットpxm，パワポの画像出力形式のwmf emf



# 新しい圧縮フォーマット
webp hief jp2
WebpとHEIFとJPEG2000．あっても使うことはまれ．
wicでは，Windows 10 では拡張（HEVC, HEIF）をインストールすればHEIF/HEVCも表示可能

プログラム（６）
Susie Plug-in
の存在するフォルダに
%afxw%\susie
を追記．
spiファイルはsusieに入れる

WIC Susie Plug-in

&S_ARC iftwic.spi

png gif
http://www.puni.jp/~overthe_stardust/susie_plugins.html

pdf md
http://yak3.myhome.cx:8080/junks/#misc.axpdf--_spi

pdf
https://mimizunoapp2.appspot.com/susie/

拡張子判別実行
DIRの時だけshift+enterが反対の窓を開く
<DIR>を作ってShift+enterに以下を定義
&EXCD -O"$P\$F\"

各種設定（２）
マークなしファイル操作→即操作する【非推奨】を選択．
非推奨な理由は，間違って操作するのを抑制するためだが，慣れたらこっちのほうが操作が早い．


キーカスタマイズ用のソフトのダウンロード
外部ツールを使ったファイル移動()
標準出力結果を内部テキストビューアで閲覧
ブックマークの追加


# Tips
## 環境変数を登録するための処理
L キーによるドライブ選択メニュー表示して，　My Doc.にカーソルを合わせたのちに _ キーを押おし，プロパティを選ぶと選択可能な画面がでる．
## mnuファイルの保存形式
SJISで保存すること．デフォルトのUTF-8だと文字化けする．

# 反対のまどを使わない操作
ほぼすべての動作が，基本的にdestが反対側の窓です．  
そのため，動作のswap領域やdestの領域として反対側の窓を合わせる操作が必要となってきます．
そのような動作は手数が一歩増えるため，特殊な操作を覚えるとよい．



# その他拡張情報リンク
[ユーザー用Wiki](http://yak3.myhome.cx:8080/afxwiki/index.php?FrontPage)
[お気に入りのツールを気ままに拡張するブログ](http://yuratomo.seesaa.net/category/10005929-1.html)

類似ツールとして
[だいなファイラー](http://hp.vector.co.jp/authors/VA004117/)
